{"version":3,"sources":["01_main.js"],"names":["game","document","getElementById","root","getContext","Records","main","gameSetting","score","grip","speed","Snake","x","y","cells","startCells","size","dx","dy","Apply","nameEntered","prompt","addEventListener","e","keyActive","target","keyCode","scoreDocument","randomApply","max","Math","floor","random","getListContent","ul","firstChild","removeChild","fragment","DocumentFragment","i","sortedMyObject","obj","Object","entries","sort","a","b","reduce","r","k","v","[object Object]","key","li","createElement","append","gameOver","valueScore","clearInterval","interval","innerHTML","setInterval","clearRect","width","height","beginPath","fillStyle","unshift","rect","fill","closePath","drawSnake","j","collision"],"mappings":"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","file":"../js/main.min.js","sourcesContent":["let game = document.getElementById(\"game__canvas\");\nlet root = game.getContext(\"2d\");\n\nlet Records = {}\n\nfunction main(){\n  let gameSetting = {\n    score : 0,\n    grip : 20,\n    speed: 13,\n  };\n  let Snake = {\n    x: 220,\n    y: 220,\n    cells: [],\n    startCells:1,\n    size: 20,\n    dx: 0,\n    dy: 0,\n  };\n  let Apply = {\n    size: 20,\n    x : 120,\n    y : 120\n  };\n  let nameEntered = prompt(\"Enter your name, please:\",'');\n  if(nameEntered === null || nameEntered === \"\") nameEntered = \"Player\";\n\n\n  document.addEventListener('keydown',function(e){\n    keyActive=e.target;\n   if(e.keyCode === 37 || e.keyCode === 65) {\n    //ArrowLeft\n    Snake.dx = -Snake.size;\n    Snake.dy =0;\n    \n   }\n   if(e.keyCode === 38 || e.keyCode === 87) {\n    //ArrowUp\n    Snake.dx = 0;\n    Snake.dy = -Snake.size;\n   }\n   if(e.keyCode === 39 || e.keyCode === 68) {\n    //ArrowRight\n    Snake.dx = Snake.size;\n    Snake.dy = 0;\n   }\n   if(e.keyCode === 40 || e.keyCode === 83) {\n    //ArrowDown\n    Snake.dx = 0;\n    Snake.dy = Snake.size;\n   }\n  },false);\n\n  let scoreDocument = document.getElementById(\"score\");\n  scoreDocument.innerHTML = gameSetting.score;\n\n\n  function randomApply(max=24){\n    return Math.floor(Math.random() * max);\n  }\n\n  function sortObject(obj) {\n    return Object.entries(obj)\n    .sort(([,a],[,b]) => b-a)\n    .reduce((r, [k, v]) => ({ ...r, [k]: v }), {});\n  }\n\n  function getListContent() {\n    while (ul.firstChild) {\n      ul.removeChild(ul.firstChild);\n    }\n    let fragment = new DocumentFragment();\n    let i=0;\n    let sortedMyObject = sortObject(Records);\n    for(let key in sortedMyObject) {\n      let li = document.createElement('li');\n      li.append(` ${ i + 1 }. ${ key } : ${ sortedMyObject[key] } `);\n      fragment.append(li);\n      i++;\n    }\n    return fragment;\n  }\n  function gameOver(){\n\n    if( Records[nameEntered] > 0) {\n      let valueScore = Records[nameEntered];\n      if(Records[nameEntered] < gameSetting.score) {\n        Records[nameEntered] = gameSetting.score;\n      } else{\n        Records[nameEntered] = valueScore;\n      }\n    } else {\n      Records[nameEntered] = gameSetting.score;\n    }\n    let listTop = [];\n    ul.append(getListContent());\n    main();\n    clearInterval(interval);\n\n  }\n\n\n  function collision(){\n    if( game.width < Snake.x + Snake.size) {\n\n      Snake.x = - Snake.size;\n\n    } else if(0 > Snake.x) {\n\n      Snake.x = game.width;\n\n    } else if(game.height  < Snake.y + Snake.size) {\n\n      Snake.y = - Snake.size;\n\n    } else if( 0 > Snake.y){ \n\n      Snake.y = game.height;\n\n    }\n    if(Snake.x === Apply.x && Snake.y === Apply.y){\n      Apply.x=randomApply()*gameSetting.grip;\n      Apply.y=randomApply()*gameSetting.grip;\n      Snake.startCells++;\n      scoreDocument.innerHTML = ++gameSetting.score;\n    }\n    for (let j = 1; j < Snake.startCells; j++) {\n        if(Snake.cells[0].x === Snake.cells[j].x && Snake.cells[0].y === Snake.cells[j].y) {\n            gameOver();\n        }\n    }\n  }\n\n\n\n\n  function drawApply(){\n    root.beginPath();\n    root.rect(Apply.x, Apply.y, Apply.size, Apply.size);\n    root.fillStyle = \"#f00\";\n    root.fill();\n    root.closePath();\n\n  }\n\n\n\n  function drawSnake() {\n    root.beginPath();\n    root.fillStyle = \"green\";\n    Snake.cells.unshift({x:Snake.x, y:Snake.y});\n    root.rect(Snake.x, Snake.y, Snake.size - 1, Snake.size - 1);\n    for (let i = 0; i < Snake.startCells; i++) {\n      createRect(Snake.cells[i].x,Snake.cells[i].y,Snake.size - 1,Snake.size - 1); \n    }\n    root.fill();\n    root.closePath();\n  }\n\n\n  function createRect(x,y,width,height){\n     root.rect(x, y, width, height);\n  }\n\n\n  function draw() {\n    root.clearRect(0, 0, game.width, game.height);\n    drawSnake();\n    collision();\n    drawApply();\n    Snake.x+= Snake.dx;\n    Snake.y+= Snake.dy;\n  }\n\n  let interval = setInterval(draw, 1000 / gameSetting.speed);\n}\n\nmain();"]}